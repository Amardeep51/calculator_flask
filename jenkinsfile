pipeline {
    agent any
    Dockerfile true

    environment{
            registry= 'https://hub.docker.com/repository/docker/amardeep51/calculator_flask'
        }

    stages {        
        stage('Compiling Stage'){
            steps{
                bat 'python calculator.py'
                echo "Compilation done successfully!"
            }
        }
        stage('Testing Stage'){
            steps{
                bat 'python test_calculator.py'
                echo "Unit Test done successfully!"
            }
        }

        stage('Final Confirmation'){
                    steps{
                        bat 'python run_tests.py'
                        echo "That is the result of testing"
                    }
                }

        stage('Building image') {
                    steps{
                        bat 'docker image build -t calculator_flask'
                        echo "Building Image done successfully"
                    }
                }

        stage('Output'){
            steps{
                bat 'python output.py'
            }
        }
    }
}
